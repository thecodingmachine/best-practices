<!doctype html>
<!--[if lt IE 7]><html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js lt-ie9 lt-ie8"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js lt-ie9"><![endif]-->
<!--[if gt IE 8]><!--> <html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js"><!--<![endif]-->
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Design beautiful classes and methods | TheCodingMachine Best practices</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="apple-touch-icon" sizes="57x57" href="/dist/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/dist/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/dist/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/dist/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/dist/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/dist/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/dist/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/dist/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/dist/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/dist/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/dist/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/dist/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/dist/img/favicon/favicon-16x16.png">

    <link href="http://fonts.googleapis.com/css?family=Roboto:400,700,300,500" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lora" rel="stylesheet" type="text/css">

    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/dist/img/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="msapplication-TileColor" content="#f01d4f">
    <meta name="msapplication-TileImage" content="http://www.thecodingmachine.com/wp-content/themes/thecodingmachine/library/images/win8-tile-icon.png">

    <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="TheCodingMachine Best practices activity feed" />
    <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
    </style>
                

    <link rel='stylesheet' id='font-awesome-css'  href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css' type='text/css' media='all' />
    <link rel='stylesheet' id='google-roboto-css'  href='//fonts.googleapis.com/css?family=Roboto%3A100%2C400%2C300%2C400italic%2C500%2C700' type='text/css' media='all' />
    <link rel='stylesheet' id='style-css'  href='/dist/css/style.css' type='text/css' media='all' />
    <link rel='stylesheet' id='hljstheme-css'  href='http://bestpractices.thecodingmachine.com/components/highlightjs/styles/darkula.css' type='text/css' media='all' />
    <!--[if lt IE 9]>
    <link rel='stylesheet' id='ie-only-css'  href='/dist/css/ie.css' type='text/css' media='all' />
    <![endif]-->
    <script type='text/javascript' src='http://bestpractices.thecodingmachine.com/components/jquery/dist/jquery.js'></script>
    <script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js'></script>
    <script type='text/javascript' src='http://bestpractices.thecodingmachine.com/dist/js/template/script.js'></script>
    <script type='text/javascript' src='http://bestpractices.thecodingmachine.com/components/highlightjs/highlight.pack.min.js'></script>

    <script type="text/javascript">
        $ = jQuery;
        $( document ).ready(function() {
            $('.scroll-contact').on('click',function () {
                var contact = $('.b-container');
                $('html,body').animate({scrollTop: contact.offset().top}, 1500);
            });

            var wi = $(window).width();

            if(wi <= 980){
                $('#header').removeClass('absolute');
            }

            $(window).scroll(function() {
                if($(window).scrollTop() > 0) {
                    $('#header').addClass('fixed');
                }else{
                    $('#header').removeClass('fixed');
                }
            });

            // browser window scroll (in pixels) after which the "back to top" link is shown
            var offset = 300,
            //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
                    offset_opacity = 1200,
            //duration of the top scrolling animation (in ms)
                    scroll_top_duration = 700,
            //grab the "back to top" link
                    $back_to_top = $('.cd-top');

            //hide or show the "back to top" link
            $(window).scroll(function(){
                ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
                if( $(this).scrollTop() > offset_opacity ) {
                    $back_to_top.addClass('cd-fade-out');
                }
            });

            //smooth scroll to top
            $back_to_top.on('click', function(event){
                event.preventDefault();
                $('body,html').animate({
                            scrollTop: 0 ,
                        }, scroll_top_duration
                );
            });
        });
    </script>
    <style>pre.hljs {padding: 5px;}
    pre.hljs code {}</style>
    <script type="text/javascript">
        (function($, window) {
            var init_fn_flag = false;
            var init_fn = (function() {
                if (init_fn_flag)
                    return;

                init_fn_flag = true;

                hljs.configure({"tabReplace":"    "});
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });

            });

            $(document).ready(init_fn);
            $(window).on("load", init_fn);
        })(jQuery, window);
    </script>
    <script>
        jQuery(function() {
            var globalFunction = new GlobalFunction();
            globalFunction.menuInitialize();
        });
    </script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-10196481-2', 'auto');
        ga('send', 'pageview');

    </script>
</head>
<body>

<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v2.3&appId=1549118041971618";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div id="wrapper" class="red">

    <header id="header">
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-sm-4 col-xs-12">
                    <strong class="logo">
                        <a href="http://www.thecodingmachine.com/">
                            <img class="logo-white" src="http://bestpractices.thecodingmachine.com/dist/img/logo-final_blanc.png" alt="TheCodingMachine">
                            <img class="logo-black" src="http://bestpractices.thecodingmachine.com/dist/img/logo-final_noir.png" alt="TheCodingMachine">
                        </a>
                    </strong>
                </div>
                <!--<div class="col-md-4 col-md-push-0 col-sm-3 col-sm-push-9 col-xs-12">
                    <h2>Best practices</h2>
                </div>-->
                <div class="col-md-8 col-sm-8 col-xs-12">
                    <nav class="navbar navbar-default">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div>
                        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                            <ul class="nav navbar-nav">
                                <li><a href="http://bestpractices.thecodingmachine.com/">ABOUT</a></li>
                                                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/development_environment.html">
                                                Development environment
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/defensive_programming.html">
                                                Defensive programming
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/error_handling.html">
                                                Error handling
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/organize_your_code.html">
                                                Organize your code
                                            </a>
                                        </li>
                                                                                                                                                <li class="active visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/design_beautiful_classes_and_methods.html">
                                                Design beautiful classes and methods
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/coding_style.html">
                                                Coding style
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/cli.html">
                                                Scripts and command line
                                            </a>
                                        </li>
                                                                                                                                                                                                                    <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/libraries/curated_list.html">
                                                Curated list of libraries
                                            </a>
                                        </li>
                                                                                                                                                <li class=" visible-xs-block">
                                            <a href="http://bestpractices.thecodingmachine.com/php/libraries/doctrine.html">
                                                Doctrine
                                            </a>
                                        </li>
                                                                                                    <li><a href="http://www.thecodingmachine.com/">TheCodingMachine</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <main id="main" role="main">
        <div class="container">
            <div class="row">
                <aside id="sidebar" class="col-lg-4 col-md-4 col-sm-4 hidden-xs">
                    <div class="sidebar">
                        <div class="sidebar-holder">
                            
                                <nav id="sidebar" class="" role="navigation">

                                    <ul class="nav nav-pills nav-stacked">
                                                                                                                                    <li>
                                                    <h4>PHP</h4>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/development_environment.html">
                                                        Development environment
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/defensive_programming.html">
                                                        Defensive programming
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/error_handling.html">
                                                        Error handling
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/organize_your_code.html">
                                                        Organize your code
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="active">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/design_beautiful_classes_and_methods.html">
                                                        Design beautiful classes and methods
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/coding_style.html">
                                                        Coding style
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/cli.html">
                                                        Scripts and command line
                                                    </a>
                                                </li>
                                                                                                                                                                                <li>
                                                    <h4>Libraries</h4>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/libraries/curated_list.html">
                                                        Curated list of libraries
                                                    </a>
                                                </li>
                                                                                                                                                                                <li class="">
                                                    <a href="http://bestpractices.thecodingmachine.com/php/libraries/doctrine.html">
                                                        Doctrine
                                                    </a>
                                                </li>
                                                                                                                        </ul>

                                </nav>

                            
                        </div>
                    </div>
                </aside>

                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 content">
                    <h1>Design beautiful classes and methods <small>PHP Best practices</small></h1>                    <h2 id="compulsory-parameters-should-be-required-in-your-constructor">Compulsory parameters should be required in your constructor</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule">Rule</h3>
<div class="alert alert-info">Your class compulsory parameters should be set in the constructor.</div>
<h3 id="explanation">Explanation</h3>
<p>The constructor is called when your class is created. If you pass the compulsory parameters to the constructor,
you know that your instance is always in a &quot;valid&quot; state.</p>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class MyService {
    private $logger;

    public function setLogger(LoggerInterface $logger): void {
        $this-&gt;logger = $logger;
    }

    private function doStuff() {
        // ...
        $this-&gt;logger-&gt;info('Hello world!');
    }
}</code></pre>
<p>The code above is evil. The <code>doStuff</code> method clearly needs the <code>$logger</code> variable to be set.
But nothing says the developers using your class that they have to set the logger.</p>
<p>Someone could call the service this way:</p>
<pre><code class="language-php">$myService = new MyService();

$myService-&gt;doStuff(); // BOOM! $this-&gt;logger is null!</code></pre>
<div class="alert alert-success">Instead, you should consider passing all required services and parameters in 
the constructor:</div>
<pre><code class="language-php">class MyService {
    private $logger;

    public function __construct(LoggerInterface $logger) {
        $this-&gt;logger = $logger;
    }

    private function doStuff(): void {
        // ...
        $this-&gt;logger-&gt;info('Hello world!');
    }
}</code></pre>
<p>With this code, there is no possible way <code>$logger</code> can be null!</p>
<h2 id="avoid-optional-services-as-much-as-possible">Avoid optional services as much as possible</h2>
<p><span class="label label-danger pull-right">Pro</span></p>
<h3 id="rule-1">Rule</h3>
<div class="alert alert-info">Avoid optional services as much as possible. Use compulsory "void" services instead</div>
<h3 id="explanation-1">Explanation</h3>
<p>It is often tempting to design a class that can optionally require some services.
For instance, a mailer service might optionally accept a logger service in order to log whether mails have been
successfully sent or not. What appears to be a good idea can actually make your code harder to read.</p>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    public function __construct(LoggerInterface $logger = null) {
        $this-&gt;logger = $logger;
    }

    private function sendMail(Mail $mail): void {
        // Do stuff that actually sends the mail...
        // ...
        if ($this-&gt;logger) {
            $this-&gt;logger-&gt;info('Mail successfully sent.');
        }
    }
}</code></pre>
<p>The <code>MyMailer</code> constructor can take a logger in parameter, but it is optional. This is great because it is flexible,
but each time we want to call the logger in the <code>MyMailer</code> code, we have to wrap the call to the logger into a <code>if</code>
statement:</p>
<pre><code class="language-php">// Each time we call the logger, we must first check that it exists.
if ($this-&gt;logger) {
    $this-&gt;logger-&gt;info('Mail successfully sent.');
}</code></pre>
<p>The additional calls to <code>if</code> make your code less readable.</p>
<p>Instead, you should consider using a &quot;void&quot; class (sometimes called a &quot;null&quot; class), i.e. a class that exhibits the
behaviour of a service but that does nothing.</p>
<div class="alert alert-success">So your code should look like this:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    public function __construct(LoggerInterface $logger) {
        $this-&gt;logger = $logger;
    }

    private function sendMail(Mail $mail): void {
        // ...
        $this-&gt;logger-&gt;info('Mail successfully sent.');
    }
}</code></pre>
<p>In the code above, the <code>$logger</code> is <strong>compulsory</strong> instead of optional.</p>
<p>If the developer does not want to log anything, he can use a <a href="https://github.com/php-fig/log/blob/master/Psr/Log/NullLogger.php"><code>NullLogger</code></a>
so that nothing is logged.</p>
<pre><code class="language-php">use Psr\Log\NullLogger;

$myMailer = new MyMailer(new NullLogger());</code></pre>
<p>Most libraries come with these kind of <em>null</em> or <em>void</em> objects. Some examples:</p>
<ul>
<li>A cache service that does not cache anything: <a href="https://github.com/doctrine/cache/blob/master/lib/Doctrine/Common/Cache/VoidCache.php"><em>Doctrine's VoidCache</em></a></li>
<li>A mailer that does not mail anything (Swift comes with a <em>null</em> mail transport)</li>
<li>...</li>
</ul>
<p>As a side note, if you are designing a new interface implemented by many classes, it is a good practice to
provide along the interface a <em>null</em> class associated to this interface.</p>
<div class="alert alert-info"><strong>Heads up!</strong> After reading this, you still want to implement 
optional parameters in your class? You should set those either using <strong>an optional constructor argument</strong>
or <strong>using a setter</strong>.</div>
<h2 id="never-use-public-properties">Never use public properties</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule-2">Rule</h3>
<div class="alert alert-info">Your class should <strong>not contain any public property</strong>.</div>
<h3 id="explanation-2">Explanation</h3>
<p>Public properties are exposing the inside of the class to the outer world.
Anyone outside the class can suddenly modify any property, therefore can put anything in the property, including
data that make no sense. Public properties decrease the <em>robustness</em> of your code.</p>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class Customer {
    public $login;
    public $password;
    /**
     * @var DateTimeImmutable
     */
    public $createTime;
}</code></pre>
<p>A developer using your class could easily write:</p>
<pre><code class="language-php">$customer = new Customer();
$customer-&gt;createTime = date(); // This is terribly wrong! We expect a DateTimeImmutable and are being given a timestamp.</code></pre>
<div class="alert alert-success">Instead, you need to 
<a href="https://en.wikipedia.org/wiki/Encapsulation_%28computer_programming%29">encapsulate properties</a> in your 
code, by using getters and setters (or getters only when it is possible). Your code should look like this:</div>
<pre><code class="language-php">class Customer {
    ...

    /**
     * @var DateTimeImmutable
     */
    private $createTime;

    public function setCreateTime(DateTimeImmutable $createTime) {
        $this-&gt;createTime = $createTime;
    }

    public function getCreateTime(): DateTimeImmutable {
        return $this-&gt;createTime;
    }
}</code></pre>
<p>Because we are using type-hinting, there is no way a developer using our class can set anything else that a
<code>DateTimeImmutable</code> instance into our <code>$createTime</code> property.</p>
<div class="alert alert-info"><strong>Heads up!</strong> Yes, writing setters and getters is a fastidious.
Please do not write those yourself. Your IDE should be able to write getters and setters for you
(and if it cannot, consider changing your IDE).</div>
<ul>
<li>PHPStorm supports generating getters and setters out of the box.</li>
<li>Eclipse PDT has <a href="http://p2-dev.pdt-extensions.org/phpfeatures.html">extensions allowing generating getters and setters too</a></li>
<li>...</li>
</ul>
<h2 id="avoid-option-arrays-in-constructors">Avoid option arrays in constructors</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule-3">Rule</h3>
<div class="alert alert-info">Avoid passing an array of options to your constructor.</div>
<h3 id="explanation-3">Explanation</h3>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class Table {
    // ...

    public function __construct(array $options) {
        // ...
    }
}</code></pre>
<p>Arrays of options are not self-explanatory. There is no way you can know all the possible keys accepted by the <code>$options</code>
array without reading the code or reading the documentation (assuming the documentation is up to date!)</p>
<div class="alert alert-success">Instead, consider passing all parameters in the constructor:</div>
<pre><code class="language-php">class Table {
    // ...

    public function __construct(array $rows, int $borderWidth = 0, string $borderColumn = "red", /*, ...*/) {
        // ...
    }
}</code></pre>
<p>If you have really too many possible options (20+ possible options with many being optional), consider writing a
<code>Configuration</code> class for your service:</p>
<pre><code class="language-php">class Table {
    // ...

    public function __construct(Configuration $configuration) {
        // ...
    }
}

class Configuration {
    private $rows;
    private $borderWidth = 0;
    private $borderColumn = "red";

    // Compulsory parameters go in the constructor
    public function __construct(array $rows) {
        $this-&gt;rows = $rows;
    }

    // Optional parameters go in setters
    public function setBorderWidth(int $borderWidth) {
        $this-&gt;borderWidth = $borderWidth;
    }

    // ...
}</code></pre>
<p>This has a number of advantages:</p>
<ul>
<li>The developer using your code cannot create an object without passing all the requested parameters</li>
<li>Your IDE can provide auto-completion on setters.</li>
</ul>
<h2 id="use-type-hinting-as-much-as-possible">Use type-hinting, as much as possible</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule-4">Rule</h3>
<div class="alert alert-info">Type-hint everything you can. If you are using PHP7, use strict mode and
scalar type hinting.</div>
<h3 id="explanation-4">Explanation</h3>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    /**
     * @param LoggerInterface $logger
     */
    public function __construct($logger) {
        $this-&gt;logger = $logger;
    }
}</code></pre>
<p>PHP is weakly typed by default. This means you could put absolutely anything in the <code>$logger</code> parameter.</p>
<p>Like this:</p>
<pre><code class="language-php">$myMailer = new MyMailer("log.txt"); // BOOM! We are expecting a logger instance, not a string!</code></pre>
<div class="alert alert-success">Instead, you should write:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    /**
     * @param LoggerInterface $logger
     */
    public function __construct(LoggerInterface $logger) {
        $this-&gt;logger = $logger;
    }
}</code></pre>
<p>With the code above, developers calling your constructor MUST pass a <code>LoggerInterface</code> to the <code>$logger</code> parameter.
Otherwise, PHP will report an error.</p>
<div class="alert alert-info">From PHP7+, you should of course use
strict mode and provide a return type for all your methods.</div>
<div class="alert alert-info"><strong>Heads up!</strong> You can enforce this rule using the <a href="https://github.com/thecodingmachine/phpstan-strict-rules/blob/master/doc/typehinting_rules.md">thecodingmachine/phpstan-strict-rules</a> package.</div>
<h2 id="write-beautiful-phpdoc">Write beautiful PHPDoc</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule-5">Rule</h3>
<div class="alert alert-info">If you cannot use a type-hint, then you must document it in a docblock.
Please add <a href="https://en.wikipedia.org/wiki/PHPDoc">PHPDoc</a> to your code <em>if it provides additional information</em>.
In particular, please detail the content of arrays using the <code>Object[]</code> notation.
If you are coding with a legacy PHP 5.x application, please also provide <code>@return</code> statements.</div>
<h3 id="explanation-5">Explanation</h3>
<p>Many tools can read the PHPDoc and help you with it.</p>
<ul>
<li>Your IDE can read it and provide auto-completion based on it</li>
<li><a href="http://mouf-php.com">Mouf</a> offers a drag'n'drop interface for instances based on PHPDoc</li>
<li><a href="http://scrutinizer-ci.com/">Scrutinizer</a> performs a number of type checks based on PHPDoc</li>
</ul>
<div class="alert alert-success">You should be sure to use the <code>Object[]</code> notation in addition to an <code>array</code> type-hint to explain what kind of object is expected.</div>
<pre><code class="language-php">/**
 * @param User[] $users
 */
public function sendSubscriptionMails(array $users) {
    foreach ($users as $user) {
        $user-&gt;getEma... // Here the IDE will be able to provide autocompletion on the $user variable based on the PHPDoc 
    }
}</code></pre>
<div class="alert alert-warning">Avoid docblocks with no value</div>
<p>You don't need to add PHPDoc for the sake of adding PHPDoc if it provides no additional value.</p>
<pre><code class="language-php">/**
 * Sets the product.
 *
 * @param Product $product
 */
public function setProduct(Product $product): void</code></pre>
<p>The PHPDoc block above is useless. It provides no additional value for the developer.</p>
<div class="alert alert-success">Only add PHPDoc when you have something to say that matters</div>
<pre><code class="language-php">/**
 * @param Product[] $products An array of products **indexed by product ID**
 */
public function setProducts(array $products): void </code></pre>
<p>The comment above is interesting as it informs the developer that the array must be indexed by product ID.
The comment is meaningful. Strive for that!</p>
<p>If all your comments actually matter, there is a bigger chance that developers using your code will actually read them.</p>
<div class="alert alert-info"><strong>Heads up!</strong> You can enforce this rule using the <a href="https://github.com/thecodingmachine/phpstan-strict-rules/blob/master/doc/typehinting_rules.md">thecodingmachine/phpstan-strict-rules</a> package.</div>
<h2 id="type-hint-on-the-interface-not-the-implementation">Type-hint on the interface, not the implementation</h2>
<p><span class="label label-danger pull-right">Pro</span></p>
<h3 id="rule-6">Rule</h3>
<div class="alert alert-info">When putting type hinting into your methods, <strong>always put an interface</strong> 
rather than a concrete class.</div>
<h3 id="explanation-6">Explanation</h3>
<p>If your class is depending on interfaces rather than classes, your class has no dependencies on a specific
implementation. Your code becomes more modular. </p>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    public function __construct(FileLogger $logger) {
        $this-&gt;logger = $logger;
    }
}</code></pre>
<p>In the example above, the <code>MyMailer</code> class requires a <code>FileLogger</code> class to run. This means that the mailer will
always write in a log file using the <code>FileLogger</code> class. This is very rigid.</p>
<div class="alert alert-success">Instead, you should write:</div>
<pre><code class="language-php">class MyMailer {
    private $logger;

    /**
     * @param LoggerInterface $logger
     */
    public function __construct(LoggerInterface $logger) {
        $this-&gt;logger = $logger;
    }
}</code></pre>
<p>Now, the <code>MyMailer</code> class can take any existing logger, including database loggers, null loggers, etc...</p>
<p>Your code becomes more <strong>decoupled</strong>.</p>
<div class="alert alert-info"><strong>Heads up!</strong> This principle is called the 
<em><a href="https://en.wikipedia.org/wiki/Dependency_inversion_principle">Dependency inversion principle</a></em> 
(not to be mistaken for the dependency injection principle which is 
something completely different). It is sometimes expressed this way: <em>Depend upon Abstractions. Do not depend upon 
concretions.</em></div>
<div class="alert alert-info"><strong>Heads up 2!</strong> This principle is very important when you are 
manipulating services, or when you are designing reusable packages. Creating an interface takes some time however,
and if you are absolutely positive that this interface will never be implemented more than once (for instance
if you are manipulating business objects or entities), it can be acceptable to type-hint on the class directly.</div>
<h2 id="avoid-passing-ids-to-methods-when-you-can-pass-objects">Avoid passing IDs to methods when you can pass objects</h2>
<p><span class="label label-success pull-right">Beginner</span></p>
<h3 id="rule-7">Rule</h3>
<div class="alert alert-info">When designing a method, prefer using objects as attributes rather than
using an ID representing these objects.</div>
<h3 id="explanation-7">Explanation</h3>
<div class="alert alert-danger">What you should NOT do:</div>
<pre><code class="language-php">class MyMailer {
    public function sendSubscriptionMail($userId) {
        // Do stuff...
    }
}</code></pre>
<p>You cannot type-hint on an ID. When an ID is passed to your method, you never know if it is a valid ID or not.</p>
<p>In the example above, a lot of things can go wrong:</p>
<pre><code class="language-php">$myMailer-&gt;sendSubscriptionMail(null); // BOOM!
$myMailer-&gt;sendSubscriptionMail(-42); // BOOM! -42 is not likely to be a valid ID</code></pre>
<div class="alert alert-success">Instead, you should consider passing directly the object 
(for instance an entity that comes from the DB).</div>
<pre><code class="language-php">class MyMailer {
    public function sendSubscriptionMail(User $user) {
        // Do stuff...
    }
}</code></pre>
<h3 id="a-quick-note-about-performance">A quick note about performance</h3>
<p>Sometimes, the service only needs the ID and nothing else stored in the object.
For instance, if you build a TODO software, you might have a service that fetches all TODOs the current user has.
The service will probably perform a query in database on the &quot;todo&quot; table, filtering on the user id.</p>
<p>It is tempting to write something like this:</p>
<pre><code class="language-php">class TodoService {
    // ...

    public function getTodoForUser($userId) {
        $sql = "SELECT * FROM todos WHERE user_id = :userId";
        return $this-&gt;db-&gt;query($sql, [ "userId", $userId ];
    }
}</code></pre>
<p>Especially, you don't have to call the <code>UserService</code> to get the <code>User</code> object, which can save an access to the database.
So this code is optimal right? Well... first of all, don't do premature optimisation.</p>
<p>Instead, please consider writing:</p>
<pre><code class="language-php">class TodoService {
    // ...

    public function getTodoForUser(User $user) {
        $sql = "SELECT * FROM todos WHERE user_id = :userId";
        return $this-&gt;db-&gt;query($sql, [ "userId", $user-&gt;getId() ];
    }
}</code></pre>
<p>Yes, you will need to retrieve the <code>$user</code> object first, but until you are facing a performance problem, this code
is more robust and safer. Also, please consider that some ORM tools have a capability for lazy-loading objects.
For instance, <a href="https://github.com/thecodingmachine/tdbm">TDBM</a> can return an instance of the <code>User</code> object without performing any call to the database. The call
is performed only when needed. So in the end, passing the <code>User</code> object could be as fast, and of course, it is
more reliable.</p>

                    <p class="fork-and-edit">
                    Found a typo? Something is wrong in this documentation? Just
                    <a href="https://github.com/thecodingmachine/best-practices/blob/master/php/design_beautiful_classes_and_methods.md">fork and edit it</a>!
                    </p>
                </div>
            </div>
        </div>
        <div class="img-block">
            <img src="http://bestpractices.thecodingmachine.com/dist/img/image13.jpg" alt="image description">
        </div>
    </main>


    <a href="#0" class="cd-top"></a>
</div> <!--  end wrapper -->
<div class="b-container">
    <div class="container">
        <aside class="row">
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                <strong class="logo"><a href="#"><img src="http://bestpractices.thecodingmachine.com/dist/img/logo.svg" alt="TheCodingMachine"></a></strong>
            </div>
            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
                <div class="row">
                    <div class="col-lg-5 col-md-6 col-sm-6 col-xs-12">
                        <address>
                            <span class="phone">Phone: <a href="tel:+33171183973">+33 1 71 18 39 73</a></span>
                            <span><a href="mailto:contact@thecodingmachine.com">contact@thecodingmachine.com</a></span>
                            <span class="address">4, Rue de la Michodi√®re<br>	PARIS - 75002<br> France</span>
                        </address>
                    </div>
                    <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12 col-lg-push-4 col-md-push-0 social-area">
                        <a href="http://www.thecodingmachine.com/entreprise#rejoindre"><strong class="title">We are hiring!</strong></a>
                        <div class="row" style="margin-top: 45px;">
                            <div class="col-xs-12">
                                <ul class="list-inline social-networks">
                                    <li><a href="https://www.facebook.com/the.coding.machine" target="_blank"><i class="fa fa-facebook fa-lg"></i></a></li>
                                    <li><a href="https://twitter.com/coding_machine" target="_blank"><i class="fa fa-twitter fa-lg"></i></a></li>
                                    <li><a href="https://www.linkedin.com/company/the-coding-machine" target="_blank"><i class="fa fa-linkedin fa-lg"></i></a></li>
                                    <!-- 											<li><a href="https://plus.google.com/104076796617273378986/posts" ><i class="fa fa-google-plus fa-lg"></i></span></a></li> -->
                                </ul>
                                <div class="fb-likes"><div class="fb-like" data-href="https://www.facebook.com/the.coding.machine" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
        <footer class="row" id="footer">
            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 col-lg-offset-4 col-md-offset-4 col-sm-offset-4 col-xs-offset-0">
                <span class="copyright">&copy; 2015 <a href="http://www.thecodingmachine.com/">TheCodingMachine</a> - All Rights Reserved</span>
                <span class="design-by">Design by <a href="http://www.allaboutdavid.fr/" target="_blank">All about david</a><br/>
                Powered by <a href="http://couscous.io/">Couscous</a></span>
            </div>
        </footer>
    </div>
</div>
</body>
</html>
